<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="가상화폐 자산추적" /><meta name="author" content="유재겸" /><meta property="og:locale" content="en" /><meta name="description" content="가상화폐 자산추적 비트코인(bitcoin)은 블록체인(blockchain)을 기반으로 만들어진 암호화폐이다. 블록체인은 누구나 거래내역을 조회 및 보관할 수 있는 투명한 구조이지만, 거래 당사자의 인증 대신 문자열로 이루어진 거래 주소를 통해 거래가 진행되기 때문에 익명성을 띈다. 이러한 익명성을 이용하여 암호화폐는 범죄에 이용되곤 한다. 2017년 갑자기 등장하여 전세계를 강타한 워너크라이의 랜섬웨어나, 불법 성착취물을 제작하여 유통한 N번방 사건에서도 대가로 암호화폐를 요구하였다. 자산추적의 의미 블록체인 네트워크는 익명성을 띄지만, 암호화폐를 이용하여 본인인증 또는 개인정보를 필요로 하는 물건구매 혹은 환전행위를 하게된다. 이 때문에 지속적인 추적을 할 경우, 소유주의 개인정보 확인이 가능해진다. 암호화폐 자산추적에 대한 연구는 국내외로 지속되고있다. 본 포스팅에서는 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’ 해당 논문에서 제시한 방안을 참고 및 응용하여 ‘암호화폐 추적 솔루션‘을 제작하였다. UTXO란? UTXO는 Unspent Transaction output의 약자로, 미사용 트랜잭션 결과물을 의미한다. 비트코인이나 큐텀의 경우에는 누군가에게 송금받은 금액을 UTXO로 저장한다. 비트코인에서는 이더리움의 계좌잔고모델(Account Transaction Model)과 달리 계정이나 잔고가 없고, UTXO를 통해 코인의 존재여부를 확인한다. (그림1)_UTXO 이미지 위 그림과 같이 사용자의 잔고 총액은, 가지고 있는 UTXO의 총합으로 이루어진다. 이제 가상화폐의 거래과정을 통해 UTXO를 보다 더 정확히 알아보자. 가상화폐에서의 거래과정 (그림2)_가상화폐 거래과정 그림1의 사용자 A가, 사용자 B에게 2BTC를 송금 완료한 경우의 그림이다. 블록체인에서의 거래는 Transaction(이하 TX)이라고 불리는 거래내역에 기록된다. TX입력부에는 이전에 가지고 있었던 5BTC에 대한 UTXO 정보가 기재되어, 다음 거래에서 이전의 거래내역을 역추적할 수 있다. (TX #1의 utxo정보는 그림1의 utxo #1을 가리키고 있다.) (그림3)_역추적 흐름도 TX를 나열하면 다음과 같은 그림으로 나타낼 수 있다. 이를 통해 마지막 트랜잭션부터 이전의 거래내역까지 거슬러 올라갈 수 있다. 위 과정을 전처리 후 작업을 거쳐 정방향으로 암호화폐의 흐름을 추적할 수 있는 솔루션을 제작하고자 한다. 개발 구조도 개발 구조도는 다음과 같다 (그림4)_개발 구조도 블록체인 네트워크(해당 글에서는 비트코인 테스트 네트워크를 사용하였다.)에서 ‘TX 수집기’가 모든 TX와 UTXO 정보에 관하여 수집한다. 수집한 TX와 UTXO정보를 json형식으로 TX DB에 저장한다. 사용자가 추적하길 원하는 TX정보를 입력한다. 탐색기에 의하여 해당 TX이후의 거래내역을 추적하여 결과물을 출력한다. TX수집기 개발 (그림5)_TX수집기 원리 TX수집기와 탐색기는 모두 Go언어로 작성되었다. 먼저 TX수집기는 Bitcoin API를 활용하여, 블록체인 네트워크 내의 모든 TX를 수집한다. 이후 해당 TX의 이전 거래내역인 UTXO 정보 또한 수집하여, 데이터베이스에 저장시켜 놓는다. 블록체인 네트워크 내의 TX수집 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 func loadblock(blocknumber string) []string { var blockhash []byte blockhash = nodecmd(&quot;getblockhash&quot;, blocknumber) //원하는 블록의 해시값을 가져옴 var blockinfo []byte blockinfo = nodecmd(&quot;getblock&quot;, string(blockhash)) //해당 블록의 정보를 불러옴 matchtxs, _ := regexp.Compile(&quot;\\[[^]]*\\]&quot;) txs := matchtxs.FindString(string(blockinfo)) matchtx, _ := regexp.Compile(&quot;[^\&quot;]*&quot;) txlist := matchtx.FindAllString(txs, -1) //정규표현식 파싱을 통하여 블록의 트랜잭션 값만 불러옴 txlist = txlist[1:] //파싱을 통한 값 첫번째에 공백이 들어가 있어서 해당부분 제거 return txlist } UTXO 정보 수집 후, json형식으로 저장 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 func savetx(txlist []string, blocknumber string) { data := make([]TxData, (len(txlist) / 2)) for i := 0; i &lt; (len(txlist) / 2); i++ { getrawtx := string(nodecmd(&quot;getrawtransaction&quot;, txlist[2*i])) //getrawtransaction 으로 해당 트랜잭션의 정보를 hex값으로 얻어옴 txinfo := string(nodecmd(&quot;decoderawtransaction&quot;, getrawtx)) //얻어온 hex값 해독 vinmatch, _ := regexp.Compile(&quot;\\[[^]]*\\]&quot;) vin := vinmatch.FindString(txinfo) //vin 파싱 pointermatch, _ := regexp.Compile(&quot;[a-z0-9]{63,64}&quot;) pointer := pointermatch.FindAllString(vin, -1) data[i].Info = txlist[2*i] data[i].Pointer = pointer } doc, _ := json.Marshal(data) // data를 JSON 문서로 변환 err2 := ioutil.WriteFile(&quot;../txinfo/&quot;+blocknumber+&quot;.json&quot;, doc, os.FileMode(0644)) // articles.json 파일에 JSON 문서 저장 if err2 != nil { fmt.Println(err2) } } 위의 두 코드는 TX수집기의 코드 일부이다. 블록체인 네트워크 내의 TX와 UTXO정보를 모두 불러와서, 정규 표현식을 통한 파싱을 진행한다. 이후, TX DB에 저장시키는 역할을 한다. 탐색기 개발 (그림6)_탐색기 원리 위의 그림과 같이 사용자 A는 추적하고 싶은 TX값을 입력하게 된다. 값을 입력받은 탐색기는, TX DB에 있는 UTXO정보를 탐색하여 일치하는 값을 찾는다. 이후 탐색한 UTXO값과 대응하는 TX값을 반환한다. TX DB에 들어있는 TX에 대응하는 UTXO정보에는 이전 거래를 가리키고 있기 때문에, UTXO정보에 대응하는 TX값은 다음 거래를 가리킨다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 func searchnexttx(searchtxinfo string, blocknumber int, root *gtree.Node) { var list []string for s := 1; s &lt; blocknumber; s++ { stostring := strconv.Itoa(s) b, err := ioutil.ReadFile(&quot;../txinfo/&quot; + stostring + &quot;.json&quot;) if err != nil { fmt.Println(err) } var data []TxData json.Unmarshal(b, &amp;data) for t := 0; t &lt; len(data); t++ { for u := 0; u &lt; len(data[t].Pointer); u++ { if data[t].Pointer[u] == searchtxinfo { list = append(list, data[t].Info) } } } } if list != nil { for i := 0; i &lt; len(list); i++ { newRoot := root.Add(list[i]) searchnexttx(list[i], blocknumber, newRoot) } } } 위의 코드는 입력한 값과 대응되는 UTXO를 찾고, 해당 UTXO값에 대응되는 TX값을 반환하는 코드이다. 이후 재귀함수를 통해서 마지막 트랜잭션에 도달하여, 더 이상 거래내역이 존재하지 않을 때까지 거래를 추적한다. 출력결과 테스트 네트워크 환경 구성 후 트랜잭션 ‘742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291’에 관한 추적을 해보았다. 출력결과 1 2 3 4 5 6 7 8 9 10 11 12 13 784c7115114ff74d49ad2624f4d520c2f60fb3ebb8480834c7c51c1427dcffa2 └── 9a1573f71f7ca2b32b17b6d3b09e5634258fbedac65552ac3a90eb5b1d40a880 ├── 55d91986122006d4537fee88f5ed042e5cd23141dc3db5765d2e72a96ef1f851 │ ├── dcd7c5f1e3fb2af005b3e48e52d24a73dbdb1c0a6fcd233e7f5ae1f1b699cf09 │ │ ├── 9dca1dfcd68b2536747776de7ae38b13873f18605a5bad42cd54ec2f4adfde5f │ │ └── 46b9f166584cef2e8d6e71274831a2206c89ed852b60f7149799a8f2d4100071 │ └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38 └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a 6e71274831a2206c89ed852b60f7149799a8f2d4100071 │ └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38 └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a └── effdab52c683c703af3848386f47c4e185dc1de67031a91dab4abe753f623c68 └── 742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291 다음과 같이 트리구조로 저장되어, 이후 거래내역을 추적할 수 있는 것을 알 수 있다. 글을 마치며 이번 포스팅에서는 비트코인이나 퀀텀에서 사용하는 UTXO정보가 트랜잭션에 남는다는 것을 활용하여, 자산추적 솔루션 개발까지 진행하였다. 본 포스팅이 생소할 수 있는 블록체인 보안에 관심이 있는 분들께, 도움이 되었으면 좋겠다. 중부대학교 보안동아리 SCP 유재겸 참고 문헌 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’" /><meta property="og:description" content="가상화폐 자산추적 비트코인(bitcoin)은 블록체인(blockchain)을 기반으로 만들어진 암호화폐이다. 블록체인은 누구나 거래내역을 조회 및 보관할 수 있는 투명한 구조이지만, 거래 당사자의 인증 대신 문자열로 이루어진 거래 주소를 통해 거래가 진행되기 때문에 익명성을 띈다. 이러한 익명성을 이용하여 암호화폐는 범죄에 이용되곤 한다. 2017년 갑자기 등장하여 전세계를 강타한 워너크라이의 랜섬웨어나, 불법 성착취물을 제작하여 유통한 N번방 사건에서도 대가로 암호화폐를 요구하였다. 자산추적의 의미 블록체인 네트워크는 익명성을 띄지만, 암호화폐를 이용하여 본인인증 또는 개인정보를 필요로 하는 물건구매 혹은 환전행위를 하게된다. 이 때문에 지속적인 추적을 할 경우, 소유주의 개인정보 확인이 가능해진다. 암호화폐 자산추적에 대한 연구는 국내외로 지속되고있다. 본 포스팅에서는 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’ 해당 논문에서 제시한 방안을 참고 및 응용하여 ‘암호화폐 추적 솔루션‘을 제작하였다. UTXO란? UTXO는 Unspent Transaction output의 약자로, 미사용 트랜잭션 결과물을 의미한다. 비트코인이나 큐텀의 경우에는 누군가에게 송금받은 금액을 UTXO로 저장한다. 비트코인에서는 이더리움의 계좌잔고모델(Account Transaction Model)과 달리 계정이나 잔고가 없고, UTXO를 통해 코인의 존재여부를 확인한다. (그림1)_UTXO 이미지 위 그림과 같이 사용자의 잔고 총액은, 가지고 있는 UTXO의 총합으로 이루어진다. 이제 가상화폐의 거래과정을 통해 UTXO를 보다 더 정확히 알아보자. 가상화폐에서의 거래과정 (그림2)_가상화폐 거래과정 그림1의 사용자 A가, 사용자 B에게 2BTC를 송금 완료한 경우의 그림이다. 블록체인에서의 거래는 Transaction(이하 TX)이라고 불리는 거래내역에 기록된다. TX입력부에는 이전에 가지고 있었던 5BTC에 대한 UTXO 정보가 기재되어, 다음 거래에서 이전의 거래내역을 역추적할 수 있다. (TX #1의 utxo정보는 그림1의 utxo #1을 가리키고 있다.) (그림3)_역추적 흐름도 TX를 나열하면 다음과 같은 그림으로 나타낼 수 있다. 이를 통해 마지막 트랜잭션부터 이전의 거래내역까지 거슬러 올라갈 수 있다. 위 과정을 전처리 후 작업을 거쳐 정방향으로 암호화폐의 흐름을 추적할 수 있는 솔루션을 제작하고자 한다. 개발 구조도 개발 구조도는 다음과 같다 (그림4)_개발 구조도 블록체인 네트워크(해당 글에서는 비트코인 테스트 네트워크를 사용하였다.)에서 ‘TX 수집기’가 모든 TX와 UTXO 정보에 관하여 수집한다. 수집한 TX와 UTXO정보를 json형식으로 TX DB에 저장한다. 사용자가 추적하길 원하는 TX정보를 입력한다. 탐색기에 의하여 해당 TX이후의 거래내역을 추적하여 결과물을 출력한다. TX수집기 개발 (그림5)_TX수집기 원리 TX수집기와 탐색기는 모두 Go언어로 작성되었다. 먼저 TX수집기는 Bitcoin API를 활용하여, 블록체인 네트워크 내의 모든 TX를 수집한다. 이후 해당 TX의 이전 거래내역인 UTXO 정보 또한 수집하여, 데이터베이스에 저장시켜 놓는다. 블록체인 네트워크 내의 TX수집 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 func loadblock(blocknumber string) []string { var blockhash []byte blockhash = nodecmd(&quot;getblockhash&quot;, blocknumber) //원하는 블록의 해시값을 가져옴 var blockinfo []byte blockinfo = nodecmd(&quot;getblock&quot;, string(blockhash)) //해당 블록의 정보를 불러옴 matchtxs, _ := regexp.Compile(&quot;\\[[^]]*\\]&quot;) txs := matchtxs.FindString(string(blockinfo)) matchtx, _ := regexp.Compile(&quot;[^\&quot;]*&quot;) txlist := matchtx.FindAllString(txs, -1) //정규표현식 파싱을 통하여 블록의 트랜잭션 값만 불러옴 txlist = txlist[1:] //파싱을 통한 값 첫번째에 공백이 들어가 있어서 해당부분 제거 return txlist } UTXO 정보 수집 후, json형식으로 저장 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 func savetx(txlist []string, blocknumber string) { data := make([]TxData, (len(txlist) / 2)) for i := 0; i &lt; (len(txlist) / 2); i++ { getrawtx := string(nodecmd(&quot;getrawtransaction&quot;, txlist[2*i])) //getrawtransaction 으로 해당 트랜잭션의 정보를 hex값으로 얻어옴 txinfo := string(nodecmd(&quot;decoderawtransaction&quot;, getrawtx)) //얻어온 hex값 해독 vinmatch, _ := regexp.Compile(&quot;\\[[^]]*\\]&quot;) vin := vinmatch.FindString(txinfo) //vin 파싱 pointermatch, _ := regexp.Compile(&quot;[a-z0-9]{63,64}&quot;) pointer := pointermatch.FindAllString(vin, -1) data[i].Info = txlist[2*i] data[i].Pointer = pointer } doc, _ := json.Marshal(data) // data를 JSON 문서로 변환 err2 := ioutil.WriteFile(&quot;../txinfo/&quot;+blocknumber+&quot;.json&quot;, doc, os.FileMode(0644)) // articles.json 파일에 JSON 문서 저장 if err2 != nil { fmt.Println(err2) } } 위의 두 코드는 TX수집기의 코드 일부이다. 블록체인 네트워크 내의 TX와 UTXO정보를 모두 불러와서, 정규 표현식을 통한 파싱을 진행한다. 이후, TX DB에 저장시키는 역할을 한다. 탐색기 개발 (그림6)_탐색기 원리 위의 그림과 같이 사용자 A는 추적하고 싶은 TX값을 입력하게 된다. 값을 입력받은 탐색기는, TX DB에 있는 UTXO정보를 탐색하여 일치하는 값을 찾는다. 이후 탐색한 UTXO값과 대응하는 TX값을 반환한다. TX DB에 들어있는 TX에 대응하는 UTXO정보에는 이전 거래를 가리키고 있기 때문에, UTXO정보에 대응하는 TX값은 다음 거래를 가리킨다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 func searchnexttx(searchtxinfo string, blocknumber int, root *gtree.Node) { var list []string for s := 1; s &lt; blocknumber; s++ { stostring := strconv.Itoa(s) b, err := ioutil.ReadFile(&quot;../txinfo/&quot; + stostring + &quot;.json&quot;) if err != nil { fmt.Println(err) } var data []TxData json.Unmarshal(b, &amp;data) for t := 0; t &lt; len(data); t++ { for u := 0; u &lt; len(data[t].Pointer); u++ { if data[t].Pointer[u] == searchtxinfo { list = append(list, data[t].Info) } } } } if list != nil { for i := 0; i &lt; len(list); i++ { newRoot := root.Add(list[i]) searchnexttx(list[i], blocknumber, newRoot) } } } 위의 코드는 입력한 값과 대응되는 UTXO를 찾고, 해당 UTXO값에 대응되는 TX값을 반환하는 코드이다. 이후 재귀함수를 통해서 마지막 트랜잭션에 도달하여, 더 이상 거래내역이 존재하지 않을 때까지 거래를 추적한다. 출력결과 테스트 네트워크 환경 구성 후 트랜잭션 ‘742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291’에 관한 추적을 해보았다. 출력결과 1 2 3 4 5 6 7 8 9 10 11 12 13 784c7115114ff74d49ad2624f4d520c2f60fb3ebb8480834c7c51c1427dcffa2 └── 9a1573f71f7ca2b32b17b6d3b09e5634258fbedac65552ac3a90eb5b1d40a880 ├── 55d91986122006d4537fee88f5ed042e5cd23141dc3db5765d2e72a96ef1f851 │ ├── dcd7c5f1e3fb2af005b3e48e52d24a73dbdb1c0a6fcd233e7f5ae1f1b699cf09 │ │ ├── 9dca1dfcd68b2536747776de7ae38b13873f18605a5bad42cd54ec2f4adfde5f │ │ └── 46b9f166584cef2e8d6e71274831a2206c89ed852b60f7149799a8f2d4100071 │ └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38 └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a 6e71274831a2206c89ed852b60f7149799a8f2d4100071 │ └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38 └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a └── effdab52c683c703af3848386f47c4e185dc1de67031a91dab4abe753f623c68 └── 742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291 다음과 같이 트리구조로 저장되어, 이후 거래내역을 추적할 수 있는 것을 알 수 있다. 글을 마치며 이번 포스팅에서는 비트코인이나 퀀텀에서 사용하는 UTXO정보가 트랜잭션에 남는다는 것을 활용하여, 자산추적 솔루션 개발까지 진행하였다. 본 포스팅이 생소할 수 있는 블록체인 보안에 관심이 있는 분들께, 도움이 되었으면 좋겠다. 중부대학교 보안동아리 SCP 유재겸 참고 문헌 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’" /><link rel="canonical" href="https://teamscp.github.io/posts/Cryotocurrency_Tracing/" /><meta property="og:url" content="https://teamscp.github.io/posts/Cryotocurrency_Tracing/" /><meta property="og:site_name" content="SCP Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-22T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="가상화폐 자산추적" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@유재겸" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"유재겸"},"dateModified":"2022-08-22T00:00:00+00:00","datePublished":"2022-08-22T00:00:00+00:00","description":"가상화폐 자산추적 비트코인(bitcoin)은 블록체인(blockchain)을 기반으로 만들어진 암호화폐이다. 블록체인은 누구나 거래내역을 조회 및 보관할 수 있는 투명한 구조이지만, 거래 당사자의 인증 대신 문자열로 이루어진 거래 주소를 통해 거래가 진행되기 때문에 익명성을 띈다. 이러한 익명성을 이용하여 암호화폐는 범죄에 이용되곤 한다. 2017년 갑자기 등장하여 전세계를 강타한 워너크라이의 랜섬웨어나, 불법 성착취물을 제작하여 유통한 N번방 사건에서도 대가로 암호화폐를 요구하였다. 자산추적의 의미 블록체인 네트워크는 익명성을 띄지만, 암호화폐를 이용하여 본인인증 또는 개인정보를 필요로 하는 물건구매 혹은 환전행위를 하게된다. 이 때문에 지속적인 추적을 할 경우, 소유주의 개인정보 확인이 가능해진다. 암호화폐 자산추적에 대한 연구는 국내외로 지속되고있다. 본 포스팅에서는 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’ 해당 논문에서 제시한 방안을 참고 및 응용하여 ‘암호화폐 추적 솔루션‘을 제작하였다. UTXO란? UTXO는 Unspent Transaction output의 약자로, 미사용 트랜잭션 결과물을 의미한다. 비트코인이나 큐텀의 경우에는 누군가에게 송금받은 금액을 UTXO로 저장한다. 비트코인에서는 이더리움의 계좌잔고모델(Account Transaction Model)과 달리 계정이나 잔고가 없고, UTXO를 통해 코인의 존재여부를 확인한다. (그림1)_UTXO 이미지 위 그림과 같이 사용자의 잔고 총액은, 가지고 있는 UTXO의 총합으로 이루어진다. 이제 가상화폐의 거래과정을 통해 UTXO를 보다 더 정확히 알아보자. 가상화폐에서의 거래과정 (그림2)_가상화폐 거래과정 그림1의 사용자 A가, 사용자 B에게 2BTC를 송금 완료한 경우의 그림이다. 블록체인에서의 거래는 Transaction(이하 TX)이라고 불리는 거래내역에 기록된다. TX입력부에는 이전에 가지고 있었던 5BTC에 대한 UTXO 정보가 기재되어, 다음 거래에서 이전의 거래내역을 역추적할 수 있다. (TX #1의 utxo정보는 그림1의 utxo #1을 가리키고 있다.) (그림3)_역추적 흐름도 TX를 나열하면 다음과 같은 그림으로 나타낼 수 있다. 이를 통해 마지막 트랜잭션부터 이전의 거래내역까지 거슬러 올라갈 수 있다. 위 과정을 전처리 후 작업을 거쳐 정방향으로 암호화폐의 흐름을 추적할 수 있는 솔루션을 제작하고자 한다. 개발 구조도 개발 구조도는 다음과 같다 (그림4)_개발 구조도 블록체인 네트워크(해당 글에서는 비트코인 테스트 네트워크를 사용하였다.)에서 ‘TX 수집기’가 모든 TX와 UTXO 정보에 관하여 수집한다. 수집한 TX와 UTXO정보를 json형식으로 TX DB에 저장한다. 사용자가 추적하길 원하는 TX정보를 입력한다. 탐색기에 의하여 해당 TX이후의 거래내역을 추적하여 결과물을 출력한다. TX수집기 개발 (그림5)_TX수집기 원리 TX수집기와 탐색기는 모두 Go언어로 작성되었다. 먼저 TX수집기는 Bitcoin API를 활용하여, 블록체인 네트워크 내의 모든 TX를 수집한다. 이후 해당 TX의 이전 거래내역인 UTXO 정보 또한 수집하여, 데이터베이스에 저장시켜 놓는다. 블록체인 네트워크 내의 TX수집 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 func loadblock(blocknumber string) []string { var blockhash []byte blockhash = nodecmd(&quot;getblockhash&quot;, blocknumber) //원하는 블록의 해시값을 가져옴 var blockinfo []byte blockinfo = nodecmd(&quot;getblock&quot;, string(blockhash)) //해당 블록의 정보를 불러옴 matchtxs, _ := regexp.Compile(&quot;\\\\[[^]]*\\\\]&quot;) txs := matchtxs.FindString(string(blockinfo)) matchtx, _ := regexp.Compile(&quot;[^\\&quot;]*&quot;) txlist := matchtx.FindAllString(txs, -1) //정규표현식 파싱을 통하여 블록의 트랜잭션 값만 불러옴 txlist = txlist[1:] //파싱을 통한 값 첫번째에 공백이 들어가 있어서 해당부분 제거 return txlist } UTXO 정보 수집 후, json형식으로 저장 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 func savetx(txlist []string, blocknumber string) { data := make([]TxData, (len(txlist) / 2)) for i := 0; i &lt; (len(txlist) / 2); i++ { getrawtx := string(nodecmd(&quot;getrawtransaction&quot;, txlist[2*i])) //getrawtransaction 으로 해당 트랜잭션의 정보를 hex값으로 얻어옴 txinfo := string(nodecmd(&quot;decoderawtransaction&quot;, getrawtx)) //얻어온 hex값 해독 vinmatch, _ := regexp.Compile(&quot;\\\\[[^]]*\\\\]&quot;) vin := vinmatch.FindString(txinfo) //vin 파싱 pointermatch, _ := regexp.Compile(&quot;[a-z0-9]{63,64}&quot;) pointer := pointermatch.FindAllString(vin, -1) data[i].Info = txlist[2*i] data[i].Pointer = pointer } doc, _ := json.Marshal(data) // data를 JSON 문서로 변환 err2 := ioutil.WriteFile(&quot;../txinfo/&quot;+blocknumber+&quot;.json&quot;, doc, os.FileMode(0644)) // articles.json 파일에 JSON 문서 저장 if err2 != nil { fmt.Println(err2) } } 위의 두 코드는 TX수집기의 코드 일부이다. 블록체인 네트워크 내의 TX와 UTXO정보를 모두 불러와서, 정규 표현식을 통한 파싱을 진행한다. 이후, TX DB에 저장시키는 역할을 한다. 탐색기 개발 (그림6)_탐색기 원리 위의 그림과 같이 사용자 A는 추적하고 싶은 TX값을 입력하게 된다. 값을 입력받은 탐색기는, TX DB에 있는 UTXO정보를 탐색하여 일치하는 값을 찾는다. 이후 탐색한 UTXO값과 대응하는 TX값을 반환한다. TX DB에 들어있는 TX에 대응하는 UTXO정보에는 이전 거래를 가리키고 있기 때문에, UTXO정보에 대응하는 TX값은 다음 거래를 가리킨다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 func searchnexttx(searchtxinfo string, blocknumber int, root *gtree.Node) { var list []string for s := 1; s &lt; blocknumber; s++ { stostring := strconv.Itoa(s) b, err := ioutil.ReadFile(&quot;../txinfo/&quot; + stostring + &quot;.json&quot;) if err != nil { fmt.Println(err) } var data []TxData json.Unmarshal(b, &amp;data) for t := 0; t &lt; len(data); t++ { for u := 0; u &lt; len(data[t].Pointer); u++ { if data[t].Pointer[u] == searchtxinfo { list = append(list, data[t].Info) } } } } if list != nil { for i := 0; i &lt; len(list); i++ { newRoot := root.Add(list[i]) searchnexttx(list[i], blocknumber, newRoot) } } } 위의 코드는 입력한 값과 대응되는 UTXO를 찾고, 해당 UTXO값에 대응되는 TX값을 반환하는 코드이다. 이후 재귀함수를 통해서 마지막 트랜잭션에 도달하여, 더 이상 거래내역이 존재하지 않을 때까지 거래를 추적한다. 출력결과 테스트 네트워크 환경 구성 후 트랜잭션 ‘742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291’에 관한 추적을 해보았다. 출력결과 1 2 3 4 5 6 7 8 9 10 11 12 13 784c7115114ff74d49ad2624f4d520c2f60fb3ebb8480834c7c51c1427dcffa2 └── 9a1573f71f7ca2b32b17b6d3b09e5634258fbedac65552ac3a90eb5b1d40a880 ├── 55d91986122006d4537fee88f5ed042e5cd23141dc3db5765d2e72a96ef1f851 │ ├── dcd7c5f1e3fb2af005b3e48e52d24a73dbdb1c0a6fcd233e7f5ae1f1b699cf09 │ │ ├── 9dca1dfcd68b2536747776de7ae38b13873f18605a5bad42cd54ec2f4adfde5f │ │ └── 46b9f166584cef2e8d6e71274831a2206c89ed852b60f7149799a8f2d4100071 │ └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38 └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a 6e71274831a2206c89ed852b60f7149799a8f2d4100071 │ └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38 └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a └── effdab52c683c703af3848386f47c4e185dc1de67031a91dab4abe753f623c68 └── 742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291 다음과 같이 트리구조로 저장되어, 이후 거래내역을 추적할 수 있는 것을 알 수 있다. 글을 마치며 이번 포스팅에서는 비트코인이나 퀀텀에서 사용하는 UTXO정보가 트랜잭션에 남는다는 것을 활용하여, 자산추적 솔루션 개발까지 진행하였다. 본 포스팅이 생소할 수 있는 블록체인 보안에 관심이 있는 분들께, 도움이 되었으면 좋겠다. 중부대학교 보안동아리 SCP 유재겸 참고 문헌 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’","headline":"가상화폐 자산추적","mainEntityOfPage":{"@type":"WebPage","@id":"https://teamscp.github.io/posts/Cryotocurrency_Tracing/"},"url":"https://teamscp.github.io/posts/Cryotocurrency_Tracing/"}</script><title>가상화폐 자산추적 | SCP Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="mask-icon" href="/assets/img/favicons/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/favicons/SCP_%EB%9D%BC%EC%9D%B83-big.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">SCP Tech Blog</a></div><div class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/TeamSCP" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.facebook.com/HackingTeamSCP" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>가상화폐 자산추적</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>가상화폐 자산추적</h1><div class="post-meta text-muted"><div> By <em> 유재겸 </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1661126400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-22 </em> </span> <span> Updated <em class="timeago" data-ts="1661126400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-22 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2127 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p><br /></p><h1 id="가상화폐-자산추적">가상화폐 자산추적</h1><hr /><p>비트코인(bitcoin)은 블록체인(blockchain)을 기반으로 만들어진 암호화폐이다.<br /> 블록체인은 누구나 거래내역을 조회 및 보관할 수 있는 투명한 구조이지만, 거래 당사자의 인증 대신 문자열로 이루어진 거래 주소를 통해 거래가 진행되기 때문에 익명성을 띈다.<br /> 이러한 익명성을 이용하여 암호화폐는 범죄에 이용되곤 한다. 2017년 갑자기 등장하여 전세계를 강타한 워너크라이의 랜섬웨어나, 불법 성착취물을 제작하여 유통한 N번방 사건에서도 대가로 암호화폐를 요구하였다. <br /><br /></p><h2 id="자산추적의-의미"><span class="mr-2">자산추적의 의미</span><a href="#자산추적의-의미" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>블록체인 네트워크는 익명성을 띄지만, 암호화폐를 이용하여 본인인증 또는 개인정보를 필요로 하는 물건구매 혹은 환전행위를 하게된다. 이 때문에 지속적인 추적을 할 경우, 소유주의 개인정보 확인이 가능해진다.<br /> 암호화폐 자산추적에 대한 연구는 국내외로 지속되고있다. 본 포스팅에서는 ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’ 해당 논문에서 제시한 방안을 참고 및 응용하여 <span style="color:red">‘<strong>암호화폐 추적 솔루션</strong>‘<span style="color:black">을 제작하였다. <br /><br /></span></span></p><h2 id="utxo란"><span class="mr-2">UTXO란?</span><a href="#utxo란" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>UTXO는 Unspent Transaction output의 약자로, 미사용 트랜잭션 결과물을 의미한다. 비트코인이나 큐텀의 경우에는 누군가에게 송금받은 금액을 UTXO로 저장한다. 비트코인에서는 이더리움의 계좌잔고모델(Account Transaction Model)과 달리 계정이나 잔고가 없고, UTXO를 통해 코인의 존재여부를 확인한다. <br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30% 30%'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/37801624/185780593-a1bb337f-f4ed-47ac-820e-d71328ddc5ea.png" width="30%" height="30%" alt="UTXO image" data-proofer-ignore><br /> (그림1)_UTXO 이미지 <br /><br /> 위 그림과 같이 사용자의 잔고 총액은, 가지고 있는 UTXO의 총합으로 이루어진다. 이제 가상화폐의 거래과정을 통해 UTXO를 보다 더 정확히 알아보자. <br /><br /></p><h2 id="가상화폐에서의-거래과정"><span class="mr-2">가상화폐에서의 거래과정</span><a href="#가상화폐에서의-거래과정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/37801624/185781992-41b9b434-3bc8-4b0c-a605-a9ccb19832e9.png" width="100%" height="100%" alt="가상화폐 거래과정" data-proofer-ignore> (그림2)_가상화폐 거래과정 <br /><br /> 그림1의 사용자 A가, 사용자 B에게 2BTC를 송금 완료한 경우의 그림이다. 블록체인에서의 거래는 Transaction(이하 TX)이라고 불리는 거래내역에 기록된다. TX입력부에는 이전에 가지고 있었던 5BTC에 대한 UTXO 정보가 기재되어, 다음 거래에서 이전의 거래내역을 역추적할 수 있다. (TX #1의 utxo정보는 그림1의 utxo #1을 가리키고 있다.) <br /><br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/37801624/185782292-4a22964c-f8f9-43e6-8579-e4d214c0e47f.png" width="100%" height="100%" alt="역추적 흐름도" data-proofer-ignore><br /> (그림3)_역추적 흐름도 <br /><br /> TX를 나열하면 다음과 같은 그림으로 나타낼 수 있다. 이를 통해 마지막 트랜잭션부터 이전의 거래내역까지 거슬러 올라갈 수 있다. 위 과정을 전처리 후 작업을 거쳐 정방향으로 암호화폐의 흐름을 추적할 수 있는 솔루션을 제작하고자 한다. <br /><br /></p><h2 id="개발-구조도"><span class="mr-2">개발 구조도</span><a href="#개발-구조도" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>개발 구조도는 다음과 같다 <br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/37801624/185782487-4e20c0b7-5fc9-4a4a-9e46-529ac4a345ad.png" width="100%" height="100%" alt="개발 구조도" data-proofer-ignore><br /> (그림4)_개발 구조도 <br /><br /></p><ol><li>블록체인 네트워크(해당 글에서는 비트코인 테스트 네트워크를 사용하였다.)에서 ‘TX 수집기’가 모든 TX와 UTXO 정보에 관하여 수집한다.<li>수집한 TX와 UTXO정보를 json형식으로 TX DB에 저장한다.<li>사용자가 추적하길 원하는 TX정보를 입력한다.<li>탐색기에 의하여 해당 TX이후의 거래내역을 추적하여 결과물을 출력한다. <br /><br /></ol><h2 id="tx수집기-개발"><span class="mr-2">TX수집기 개발</span><a href="#tx수집기-개발" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p><br /><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/37801624/185793113-d3cd5ba9-eacf-470a-bfbc-9fbf04f1b834.png" width="100%" height="100%" alt="수집기 원리" data-proofer-ignore><br /> (그림5)_TX수집기 원리 <br /><br /> TX수집기와 탐색기는 모두 Go언어로 작성되었다. 먼저 TX수집기는 Bitcoin API를 활용하여, 블록체인 네트워크 내의 모든 TX를 수집한다. 이후 해당 TX의 이전 거래내역인 UTXO 정보 또한 수집하여, 데이터베이스에 저장시켜 놓는다. <br /><br /> 블록체인 네트워크 내의 TX수집</p><div class="language-golang highlighter-rouge"><div class="code-header"> <span data-label-text="Golang"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">func</span> <span class="n">loadblock</span><span class="p">(</span><span class="n">blocknumber</span> <span class="kt">string</span><span class="p">)</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">blockhash</span> <span class="p">[]</span><span class="kt">byte</span>

	<span class="n">blockhash</span> <span class="o">=</span> <span class="n">nodecmd</span><span class="p">(</span><span class="s">"getblockhash"</span><span class="p">,</span> <span class="n">blocknumber</span><span class="p">)</span>
	<span class="c">//원하는 블록의 해시값을 가져옴</span>

	<span class="k">var</span> <span class="n">blockinfo</span> <span class="p">[]</span><span class="kt">byte</span>
	<span class="n">blockinfo</span> <span class="o">=</span> <span class="n">nodecmd</span><span class="p">(</span><span class="s">"getblock"</span><span class="p">,</span> <span class="kt">string</span><span class="p">(</span><span class="n">blockhash</span><span class="p">))</span>
	<span class="c">//해당 블록의 정보를 불러옴</span>

	<span class="n">matchtxs</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">Compile</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">[[^]]*</span><span class="se">\\</span><span class="s">]"</span><span class="p">)</span>
	<span class="n">txs</span> <span class="o">:=</span> <span class="n">matchtxs</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="kt">string</span><span class="p">(</span><span class="n">blockinfo</span><span class="p">))</span>
	<span class="n">matchtx</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">Compile</span><span class="p">(</span><span class="s">"[^</span><span class="se">\"</span><span class="s">]*"</span><span class="p">)</span>
	<span class="n">txlist</span> <span class="o">:=</span> <span class="n">matchtx</span><span class="o">.</span><span class="n">FindAllString</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="o">-</span><span class="m">1</span><span class="p">)</span>
	<span class="c">//정규표현식 파싱을 통하여 블록의 트랜잭션 값만 불러옴</span>
	<span class="n">txlist</span> <span class="o">=</span> <span class="n">txlist</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">]</span>
	<span class="c">//파싱을 통한 값 첫번째에 공백이 들어가 있어서 해당부분 제거</span>
	<span class="k">return</span> <span class="n">txlist</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><p>UTXO 정보 수집 후, json형식으로 저장</p><div class="language-golang highlighter-rouge"><div class="code-header"> <span data-label-text="Golang"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">func</span> <span class="n">savetx</span><span class="p">(</span><span class="n">txlist</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="n">blocknumber</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>

	<span class="n">data</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="n">TxData</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">txlist</span><span class="p">)</span> <span class="o">/</span> <span class="m">2</span><span class="p">))</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">txlist</span><span class="p">)</span> <span class="o">/</span> <span class="m">2</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">getrawtx</span> <span class="o">:=</span> <span class="kt">string</span><span class="p">(</span><span class="n">nodecmd</span><span class="p">(</span><span class="s">"getrawtransaction"</span><span class="p">,</span> <span class="n">txlist</span><span class="p">[</span><span class="m">2</span><span class="o">*</span><span class="n">i</span><span class="p">]))</span>
		<span class="c">//getrawtransaction 으로 해당 트랜잭션의 정보를 hex값으로 얻어옴</span>
		<span class="n">txinfo</span> <span class="o">:=</span> <span class="kt">string</span><span class="p">(</span><span class="n">nodecmd</span><span class="p">(</span><span class="s">"decoderawtransaction"</span><span class="p">,</span> <span class="n">getrawtx</span><span class="p">))</span>
		<span class="c">//얻어온 hex값 해독</span>
		<span class="n">vinmatch</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">Compile</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">[[^]]*</span><span class="se">\\</span><span class="s">]"</span><span class="p">)</span>
		<span class="n">vin</span> <span class="o">:=</span> <span class="n">vinmatch</span><span class="o">.</span><span class="n">FindString</span><span class="p">(</span><span class="n">txinfo</span><span class="p">)</span>
		<span class="c">//vin 파싱</span>
		<span class="n">pointermatch</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">Compile</span><span class="p">(</span><span class="s">"[a-z0-9]{63,64}"</span><span class="p">)</span>
		<span class="n">pointer</span> <span class="o">:=</span> <span class="n">pointermatch</span><span class="o">.</span><span class="n">FindAllString</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span> <span class="o">-</span><span class="m">1</span><span class="p">)</span>
		<span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Info</span> <span class="o">=</span> <span class="n">txlist</span><span class="p">[</span><span class="m">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>
		<span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Pointer</span> <span class="o">=</span> <span class="n">pointer</span>
	<span class="p">}</span>
	<span class="n">doc</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c">// data를 JSON 문서로 변환</span>

	<span class="n">err2</span> <span class="o">:=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">WriteFile</span><span class="p">(</span><span class="s">"../txinfo/"</span><span class="o">+</span><span class="n">blocknumber</span><span class="o">+</span><span class="s">".json"</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">FileMode</span><span class="p">(</span><span class="m">0644</span><span class="p">))</span> <span class="c">// articles.json 파일에 JSON 문서 저장</span>
	<span class="k">if</span> <span class="n">err2</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">err2</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위의 두 코드는 TX수집기의 코드 일부이다. 블록체인 네트워크 내의 TX와 UTXO정보를 모두 불러와서, 정규 표현식을 통한 파싱을 진행한다. 이후, TX DB에 저장시키는 역할을 한다. <br /><br /></p><h2 id="탐색기-개발"><span class="mr-2">탐색기 개발</span><a href="#탐색기-개발" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p><br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/37801624/185792635-3a70396e-4eb1-4715-9ea7-aeb186cc62b3.png" width="100%" height="100%" alt="탐색기 원리" data-proofer-ignore><br /> (그림6)_탐색기 원리 <br /><br /> 위의 그림과 같이 사용자 A는 추적하고 싶은 TX값을 입력하게 된다. 값을 입력받은 탐색기는, TX DB에 있는 UTXO정보를 탐색하여 일치하는 값을 찾는다. 이후 탐색한 UTXO값과 대응하는 TX값을 반환한다. TX DB에 들어있는 TX에 대응하는 UTXO정보에는 이전 거래를 가리키고 있기 때문에, UTXO정보에 대응하는 TX값은 다음 거래를 가리킨다. <br /></p><div class="language-golang highlighter-rouge"><div class="code-header"> <span data-label-text="Golang"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">func</span> <span class="n">searchnexttx</span><span class="p">(</span><span class="n">searchtxinfo</span> <span class="kt">string</span><span class="p">,</span> <span class="n">blocknumber</span> <span class="kt">int</span><span class="p">,</span> <span class="n">root</span> <span class="o">*</span><span class="n">gtree</span><span class="o">.</span><span class="n">Node</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">list</span> <span class="p">[]</span><span class="kt">string</span>
	<span class="k">for</span> <span class="n">s</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="n">blocknumber</span><span class="p">;</span> <span class="n">s</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">stostring</span> <span class="o">:=</span> <span class="n">strconv</span><span class="o">.</span><span class="n">Itoa</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="n">b</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="s">"../txinfo/"</span> <span class="o">+</span> <span class="n">stostring</span> <span class="o">+</span> <span class="s">".json"</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
			<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
		<span class="p">}</span>
		<span class="k">var</span> <span class="n">data</span> <span class="p">[]</span><span class="n">TxData</span>
		<span class="n">json</span><span class="o">.</span><span class="n">Unmarshal</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">);</span> <span class="n">t</span><span class="o">++</span> <span class="p">{</span>
			<span class="k">for</span> <span class="n">u</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">Pointer</span><span class="p">);</span> <span class="n">u</span><span class="o">++</span> <span class="p">{</span>
				<span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">Pointer</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">searchtxinfo</span> <span class="p">{</span>
					<span class="n">list</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">Info</span><span class="p">)</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">list</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">list</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
			<span class="n">newRoot</span> <span class="o">:=</span> <span class="n">root</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="n">searchnexttx</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">blocknumber</span><span class="p">,</span> <span class="n">newRoot</span><span class="p">)</span>
		<span class="p">}</span>

	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위의 코드는 입력한 값과 대응되는 UTXO를 찾고, 해당 UTXO값에 대응되는 TX값을 반환하는 코드이다. 이후 재귀함수를 통해서 마지막 트랜잭션에 도달하여, 더 이상 거래내역이 존재하지 않을 때까지 거래를 추적한다. <br /> <br /></p><h2 id="출력결과"><span class="mr-2">출력결과</span><a href="#출력결과" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>테스트 네트워크 환경 구성 후 트랜잭션 ‘742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291’에 관한 추적을 해보았다. <br /><br /> 출력결과</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre> 784c7115114ff74d49ad2624f4d520c2f60fb3ebb8480834c7c51c1427dcffa2
└── 9a1573f71f7ca2b32b17b6d3b09e5634258fbedac65552ac3a90eb5b1d40a880
    ├── 55d91986122006d4537fee88f5ed042e5cd23141dc3db5765d2e72a96ef1f851
    │   ├── dcd7c5f1e3fb2af005b3e48e52d24a73dbdb1c0a6fcd233e7f5ae1f1b699cf09
    │   │   ├── 9dca1dfcd68b2536747776de7ae38b13873f18605a5bad42cd54ec2f4adfde5f
    │   │   └── 46b9f166584cef2e8d6e71274831a2206c89ed852b60f7149799a8f2d4100071
    │   └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38
    └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a
6e71274831a2206c89ed852b60f7149799a8f2d4100071
    │   └── df44f4c5e58ba2bdb721eadf6bce0203d880282a020bb0ee623193ea7246df38
    └── 1059678796083d29953aa7771d70a4e36dadd5d698de080fcea8ef8d84fcb15a
        └── effdab52c683c703af3848386f47c4e185dc1de67031a91dab4abe753f623c68
            └── 742718dc9625c6aac6eca4b57d93051208540cd3d65773a41131ce77eee16291
</pre></table></code></div></div><p>다음과 같이 트리구조로 저장되어, 이후 거래내역을 추적할 수 있는 것을 알 수 있다.</p><p><br /></p><h2 id="글을-마치며"><span class="mr-2">글을 마치며</span><a href="#글을-마치며" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>이번 포스팅에서는 비트코인이나 퀀텀에서 사용하는 UTXO정보가 트랜잭션에 남는다는 것을 활용하여, 자산추적 솔루션 개발까지 진행하였다. 본 포스팅이 생소할 수 있는 블록체인 보안에 관심이 있는 분들께, 도움이 되었으면 좋겠다. <br /> <span style="color:skyblue">중부대학교 보안동아리 SCP 유재겸 <br /></span></p><h2 id="참고-문헌"><span class="mr-2">참고 문헌</span><a href="#참고-문헌" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><br /> ‘박순태, 신용희, 강홍구.(2020).사이버 범죄에 악용되는 암호화폐 불법거래 추적.정보과학회지,38(9),40-47.’</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blockchain/'>Blockchain</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/blockchain/" class="post-tag no-text-decoration" >blockchain</a> <a href="/tags/bitcoin/" class="post-tag no-text-decoration" >bitcoin</a> <a href="/tags/utxo/" class="post-tag no-text-decoration" >utxo</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=가상화폐 자산추적 - SCP Tech Blog&amp;url=https://teamscp.github.io/posts/Cryotocurrency_Tracing/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=가상화폐 자산추적 - SCP Tech Blog&amp;u=https://teamscp.github.io/posts/Cryotocurrency_Tracing/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://teamscp.github.io/posts/Cryotocurrency_Tracing/&amp;text=가상화폐 자산추적 - SCP Tech Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/About_SCP/">About_SCP</a><li><a href="/posts/BruteForce/">Brute Force</a><li><a href="/posts/SQL-injection/">SQL Injection </a><li><a href="/posts/Stack_Frame/">스택(Stack)과 스택 프레임(Stack Frame)</a><li><a href="/posts/FSB/">FSB</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/apihooking/">APIHooking</a> <a class="post-tag" href="/tags/bcrypt/">Bcrypt</a> <a class="post-tag" href="/tags/bitcoin/">bitcoin</a> <a class="post-tag" href="/tags/blockchain/">blockchain</a> <a class="post-tag" href="/tags/brute-force/">Brute Force</a> <a class="post-tag" href="/tags/flask/">Flask</a> <a class="post-tag" href="/tags/fsb/">FSB</a> <a class="post-tag" href="/tags/hackrf/">HackRF</a> <a class="post-tag" href="/tags/jwt/">JWT</a> <a class="post-tag" href="/tags/promotion/">promotion</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/BruteForce/"><div class="card-body"> <em class="timeago small" data-ts="1663027200" > 2022-09-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Brute Force</h3><div class="text-muted small"><p> Brute Force 이란? 영어로 Brute 는 “짐승 같은,난폭한”이라는 뜻이고, Brute Force는 “난폭한 힘,폭력”이라는 뜻으로 조합 가능한 모든 문자열을 하나씩 대입하여 암호를 해독하는 방법이다. Brute Force 장점 이론적으로 가능한 모든 경우의 수를 다 검색해 보는 것이라 정확도 100%가 항상 보장된다. 또한 브루트 포스의...</p></div></div></a></div><div class="card"> <a href="/posts/About_SCP/"><div class="card-body"> <em class="timeago small" data-ts="1662422400" > 2022-09-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>About_SCP</h3><div class="text-muted small"><p> About_SCP 소개말 중부대학교 SCP 동아리는 정보보호학과 유승재 교수님의 지도하의 정보보호 연구 동아리입니다. 1998년 정보보호 창업 동아리 Soul Magic으로 창설해, 2005년 Security Check Point의 약자인 S.C.P로 바꾸어 활동하고 있습니다. S.C.P는 중부대학교 고양캠퍼스 세종관 804호에 위치하고 있으며 동...</p></div></div></a></div><div class="card"> <a href="/posts/Stack_Frame/"><div class="card-body"> <em class="timeago small" data-ts="1661644800" > 2022-08-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>스택(Stack)과 스택 프레임(Stack Frame)</h3><div class="text-muted small"><p> 스택(Stack) 스택(Stack)의 개념 LIFO(Last In First Out) 또는 FILO(First In Last Out) 형태로 동작하는 선형 자료 구조 스택(Stack)의 사전적 의미는 “더미”, “쌓다”로 자료 구조의 스택도 데이터를 순차적으로 나열한 구조이다. 가장 최근에 보관한 자료를 꺼내는 방식으로 동작한다. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/HackRF_Introduce/" class="btn btn-outline-primary" prompt="Newer"><p>[전파해킹] HackRF 소개와 환경 구축 (우분투)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="">SCP</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/apihooking/">APIHooking</a> <a class="post-tag" href="/tags/bcrypt/">Bcrypt</a> <a class="post-tag" href="/tags/bitcoin/">bitcoin</a> <a class="post-tag" href="/tags/blockchain/">blockchain</a> <a class="post-tag" href="/tags/brute-force/">Brute Force</a> <a class="post-tag" href="/tags/flask/">Flask</a> <a class="post-tag" href="/tags/fsb/">FSB</a> <a class="post-tag" href="/tags/hackrf/">HackRF</a> <a class="post-tag" href="/tags/jwt/">JWT</a> <a class="post-tag" href="/tags/promotion/">promotion</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
